PRIMER ALIGNEMNT WITH BLAST

This script performs an alignment of all primers listed in the primer database file against all sequences in the Sequences folder with the BLAST algorithm. 

The alignment with the best BLAST score is chosen for further downstream analysis where some basic calculations (Python script) are performed and then visualized with R (see below for details).


PYTHON SCRIPT

The Python script makes a data table consisting of several columns including the total mismatches (nucleotide mismatches, gaps, and unaligned parts of the primer), a match percentage, and alignment length. 

The script also discards primer alignments that are not applicable for the subtype (H1 primers are removed for H3 sequences etc.).


R SCRIPT

The R script is just visualizing the data table generated by the Python script. The heatmap shows the primer at the x-axis and the sequences align at the y-axis. The fill of the heatmap is showing the number of total mismatches, while the number displayed in each square is the difference between the length of the primer and the alignment (alignment difference number, ADN). If the number displayed is higher than zero, the alignment is not aligned with the whole primer while a number lower than zero indicates a gap or insertion. 

INTERPRETATION

The interpretation of the heatmap is mostly straightforward, but it is important to take the ADN into consideration. A sample may have several mismatches in the heatmap, but if the ADN is high the mismatch number may be lower due to an unoptimized alignment. The rule of thumb is then to always take a closer look at samples with a high ADN before concluding. 






